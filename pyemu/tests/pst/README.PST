Feinstein, USGS
December 2009


PEST is the parameter estimation tool used to calibrate the base CONFINED model,SLMB-C, and the alternative UNCONFINED model, SLMB-U.  

The initial parameters for the CONFINED run refer to a model version called STF2sCFX.  
The final CONFINED calibration run was called STPEST3C_3k_iter5 and produced the base model SLMB-C.

The initial parameters for the UNCONFINED run refer to a model version called STF2sFIX.
The final UNCONFINED calibration run was called STPEST3U_3k_iter4 and produced the alternative model SLMB-U.

********************************************************************************************************************************************************

The CODE_SOURCE directory contains the source code files for PEST version 11 from Watermark Numerical Computing under the subdirectory "pest11_including_source".
The directory also contains the source code for 10 utility programs used in customizing PEST to the LMB model.

********************************************************************************************************************************************************

The EXECUTABLE directory contains programs used to execute PEST,to prepare input for each PEST update and to load PEST again with calibrated model results to generate calibration statistics.
The PEST executable is version 11.5 from Watermark Numerical Computing (John Doherty) dated 2/18/2008.


********************************************************************************************************************************************************

The INPUT subdirectories contains all the programs and input files needed to prepare input for each PEST update for the CONFINED and UNCONFINED model versions.  
The procedure (so-called "PEST chain" is launched from the command line with the command STPEST3C in the CONFINED subdirectory and with the command STPEST3U in the UNCONFINED subdirectory.
The procedure does not execute PEST, it only prepares the files needed to execute PEST.  By changing inputs to the model the user can generate new input files for PEST.

********************************************************************************************************************************************************

The OUTPUT subdirectory conatins parameter values, observation values and calibration statistics for the two final calibration runs, STPEST3C_3k_iter5 and STPEST3U_3k_iter4.

The REC files contain direct PEST output related to objective function and other statistical results.  
The RES files contain direct PEST output comparing of measured to simulated target values values.
The REI files contain analyses of PEST output, with breakdowns by target group and summary calibration statistics.  
The PHI files contain tables showing the contribution of each target group to the objective function.
The BPA files contain listings of calibrated parameter values and show the degree of change from initial values.

There are two subdirectories - one for the CONFINED output and one for the UNCONFINED output.

********************************************************************************************************************************************************

The RUN_PEST subdirectory contains all the input files needed to run PEST for the base CONFINED model. 

The DOS command is:
PEST STPEST3C_3K_BPA5_SLMB-C_CALIB.PST 
    where PEST is the executable and STPEST3C_3K_BPA5_SLMB-C_CALIB.PST is the control file for PEST corresponding to the base CONFINED model.  

The input files in this directory allow PEST to generate the "optimal" parameters used in the base CONFINED simulation.  The model is firt run with
SWT_v44x.EXE and then PEST calibration output files are produced with the root name SPTEST3C. 

Note:  The "SWT_v44x.exe" executable is identical to "SWT_v44.exe" except that it allows the code to continue even if convergence is not attained during a 
time step - which is potentially useful during automated calibration in order to avoid prematurely terminating the regression procedure.

Note:  The NOPTMAX parameter in the STPEST3C_BEST_BPA5.PST control file is set to "0", which stops PEST from optimizing further on the initial parameter multipliers.  
If further optimization is desired, NOPTMAX must be set to a number greater than "0".

Note:	The model input in this directory is negligibly different than the BASE model, which results in a PHI objective function value of 4.681e5 in the REC file
instead of the 4.680e5 value associated with the BASE model (see the STAT_ANALYSIS subdirectory).  This difference is insignificant in all practical respects.

********************************************************************************************************************************************************

The STAT_ANALYSIS subdirectory contains all programs and input files needed to generate calibration statistics from the output of a calibrated or trial model,i.e., from a model 
version containing parameter values from a selected PEST iteration or from a modified version of the calibrated model.  This subdirectory is useful if a change is made to the 
BASE version of the model and the user wants to know the effect on calibration statistics.

The needed model output are files with binary head output, bindary drawdown output, binary cell-by-cell flow output, and the ascii LST file.
For the base CONFINED model, these files correspond to SLMB-C.HDS, SLMB-C.DDN, SLMB-C.CBB and SLMB-C.LST.
For the alternative UNCONFINED model, these files correspond to SLMB-U.HDS, SLMB-U.DDN, SLMB-U.CBB and SLMB-U.LST.
Before the procedure can be launched, each of these files must be copied to the rootname STPEST1C, e.g., SLMB-C.HDS => STPEST1C.HDS.

The procedure is launched from a command line with the command:
PEST TEST,
where PEST is an executable and TEST is a batch file.

The procedure produces a TEST.REC file (which contains calibration statistics and a TEST.RES file (which contains comparison of observed to simulated target values).   
They should be renamed with the root name of the model simulation, e.g., SLMB-C or SLMB-U.

********************************************************************************************************************************************************

More information on the use of PEST is contained in the report.